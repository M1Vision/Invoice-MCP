# Smithery configuration file: https://smithery.ai/docs/build/project-config

runtime: container
build:
  dockerfile: Dockerfile
  dockerBuildPath: .
startCommand:
  type: http
  configSchema:
    type: object
    required:
      - supabaseUrl
      - supabaseKey
    properties:
      # REQUIRED: Supabase Connection
      supabaseUrl:
        type: string
        title: "Supabase Project URL"
        description: "Your Supabase project URL (e.g., https://your-project.supabase.co)"
        pattern: "^https://.*\\.supabase\\.co$"
      supabaseKey:
        type: string
        title: "Supabase Anon Key"
        description: "Your Supabase anonymous/public API key for authentication"
      
      # OPTIONAL: Storage Configuration (defaults work for most cases)
      storageBucket:
        type: string
        title: "Storage Bucket Name"
        description: "Supabase storage bucket name for PDF files (default: invoices)"
        default: "invoices"
      autoCreateBucket:
        type: boolean
        title: "Auto-create Storage Bucket"
        description: "Requires a Supabase service role key. Disable when using an anon key (default: false)."
        default: false

      # OPTIONAL: Business Information (for invoice branding)
      businessName:
        type: string
        title: "Business Name"
        description: "Your business name (appears on invoices)"
      businessEmail:
        type: string
        title: "Business Email"
        description: "Your business email address"
        format: "email"
      businessPhone:
        type: string
        title: "Business Phone"
        description: "Your business phone number"
      businessAddress:
        type: string
        title: "Business Address"
        description: "Your business address (appears on invoices)"

      enableMetadataStorage:
        type: boolean
        title: "(Deprecated) Database Storage"
        description: "Kept for backwards compatibility. Metadata storage is currently disabled and this flag is ignored."
        default: false
  exampleConfig:
    supabaseUrl: "https://mohsljimdduthwjhygkp.supabase.co"
    supabaseKey: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
    storageBucket: "invoices"
    autoCreateBucket: false
    businessName: "My Business Ltd"
    businessEmail: "contact@mybusiness.com"
    businessPhone: "+44 123 456 7890"
    businessAddress: "123 Business St, London, UK"
    enableMetadataStorage: false

# Environment variables for Smithery scanning (used when no test profile configured)
env:
  SUPABASE_URL: "https://mohsljimdduthwjhygkp.supabase.co"
  SUPABASE_KEY: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1vaHNsamltZGR1dGh3amh5Z2twIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYxMDgwMDUsImV4cCI6MjA3MTY4NDAwNX0.jacpTDGtJByh8xUvUguZCofMK08af1yFjfGtDzvL7o4"
  STORAGE_BUCKET: "invoices"
  AUTO_CREATE_BUCKET: "false"
